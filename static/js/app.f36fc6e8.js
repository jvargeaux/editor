(()=>{"use strict";var e={2102:(e,t,n)=>{n(3792),n(3362),n(9085),n(9391);var o=n(2856),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[];const d={name:"App",components:{}},a=d;var r=n(1656),c=(0,r.A)(a,s,i,!1,null,null,null);const l=c.exports;var u=n(1594),_=(n(6034),n(7495),n(906),function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("br"),t("br"),t("div",{class:"document-panel ".concat(e.is_document_panel_open?"open":"")},[t("span",{staticClass:"documents-title"},[e._v("Documents")]),t("button",{on:{click:function(t){return e.newDocument()}}},[e._v("New")]),t("br"),e._l(Object.values(e.documents),(function(n){return t("div",{staticClass:"document",on:{click:function(t){return e.fetchDocument(n.id)}}},[t("p",[e._v(e._s(n.title||"(Untitled)"))])])}))],2),t("div",{staticClass:"toolbar"},[t("button",{on:{click:function(t){e.is_document_panel_open=!e.is_document_panel_open}}},[e._v("Documents")]),t("button",{class:"edit-toggle ".concat(e.editing?"on":"off"),on:{click:function(t){e.editing=!e.editing}}},[e._v(e._s(e.editing?"Editing On":"Editing Off"))]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("h1","",null)}}},[e._v("H1")]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("h2","",null)}}},[e._v("H2")]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("h3","",null)}}},[e._v("H3")]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("h4","",null)}}},[e._v("H4")]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("p","",null)}}},[e._v("P")]),t("button",{on:{click:function(){return e.apply_to_selected_nodes("li","","ul")}}},[e._v("B")]),t("button",{on:{click:function(){return e.test()}}},[e._v("Test")]),t("button",{on:{click:function(){return e.selectionToNode("p","node blockquote",null)}}},[e._v("Q")])]),t("div",{staticClass:"save-indicator"},["pending"==e.save_status?t("div",{staticClass:"saving pending"},[t("div",{staticClass:"saving-loader"}),t("span",[e._v("Saving...")])]):"success"==e.save_status?t("div",{staticClass:"saving"},[t("span",[e._v("Last Saved: "+e._s(e.last_saved)+".")])]):"error"==e.save_status?t("div",{staticClass:"saving error"},[t("span",[e._v("Connection Error.")])]):e._e()]),t("div",{attrs:{id:"nodes",contenteditable:e.editing}})])}),f=[],h=n(7262),p=n(5060),m=n(8643);n(6918),n(8706),n(5276),n(4114),n(4782),n(4554),n(9089),n(739),n(3288),n(3110),n(9432),n(6099),n(8781),n(6031);function v(e,t,n){return fetch(e,{method:t,headers:{"Content-Type":"application/json",Authorization:window.localStorage.getItem("token")||""},body:JSON.stringify(n)}).then((function(e){return 404==e.status?e:e.json().then((function(t){return(0,m.A)((0,m.A)({},t),{},{ok:e.ok,status:e.status})}))}))}const g={name:"Home",components:{},data:function(){return{editing:!1,undo_history:[],undo_step:1,max_undo_history:10,debounce_timepoint:null,DEBOUNCE_TIME:1e3,last_saved:null,save_status:"",documents:{},current_document_id:null,is_document_panel_open:!1}},methods:{debounce:function(){var e=this;return this.debounce_timepoint=Date.now(),new Promise((function(t,n){window.setTimeout((function(){Date.now()>e.debounce_timepoint+e.DEBOUNCE_TIME&&t(!0)}),e.DEBOUNCE_TIME)}))},test:function(){v("http://127.0.0.1:5000/test/","POST",{}).then((function(e){console.log(e)}))},saveDocument:function(){var e=this;this.save_status="pending",v("http://127.0.0.1:5000/save/".concat(this.current_document_id),"POST",{document:document.getElementById("nodes").innerHTML}).then((function(t){window.setTimeout((function(){e.save_status=t.ok?"success":"error",e.last_saved=t.last_saved||""}),200)})).then((function(){e.fetchAllDocuments()}))},fetchDocument:function(e){var t=this;v("http://127.0.0.1:5000/fetch/".concat(e),"POST",{}).then((function(n){console.log(n),n.ok?(document.getElementById("nodes").innerHTML=n.document,t.save_status="success",t.last_saved=n.last_saved||"",t.is_document_panel_open=!1,t.editing=!1,t.current_document_id=e,window.localStorage.setItem("current_document_id",e)):t.save_status="error"}))},fetchAllDocuments:function(){var e=this;v("http://127.0.0.1:5000/fetch_all","POST",{}).then((function(t){console.log(t),e.documents=t.documents||{}}))},newDocument:function(){var e=this;v("http://127.0.0.1:5000/new","POST",{}).then((function(t){console.log(t),e.current_document_id=t.id||null,e.save_status=t.ok?"success":"error",e.last_saved=t.last_saved||"",e.is_document_panel_open=!1,window.localStorage.setItem("current_document_id",t.id),e.fetchAllDocuments(),e.fetchDocument(t.id)}))},updateUndoHistory:function(){this.undo_history.push(JSON.stringify(this.nodes)),this.undo_history=this.undo_history.slice(-this.max_undo_history),window.localStorage.setItem("undo_history",this.undo_history),console.log(this.undo_history)},undo:function(){this.undo_step<this.undo_history.length&&this.undo_step++;var e=-this.undo_step;this.nodes=JSON.parse(this.undo_history.slice(e).shift())},redo:function(){this.undo_step>1&&this.undo_step--;var e=-this.undo_step;this.nodes=JSON.parse(this.undo_history.slice(e).shift())},getSelectionInfo:function(){var e=window.getSelection();if(!e.baseNode||!e.extentNode)return{start_node_index:-1,start_offset:-1,start_node_content:"",end_node_index:-1,end_offset:-1,end_node_content:"",has_selection:!1};var t={node:e.baseNode,node_index:Array.prototype.indexOf.call(e.baseNode.parentElement.parentElement.children,e.baseNode.parentElement),subnode_index:Array.prototype.indexOf.call(e.baseNode.parentElement.children,e.baseNode),offset:e.baseOffset},n={node:e.extentNode,node_index:Array.prototype.indexOf.call(e.extentNode.parentElement.parentElement.children,e.extentNode.parentElement),subnode_index:Array.prototype.indexOf.call(e.extentNode.parentElement.children,e.extentNode),offset:e.extentOffset},o=t.node_index<=n.node_index?(0,m.A)({},t):(0,m.A)({},n),s=t.node_index<=n.node_index?(0,m.A)({},n):(0,m.A)({},t);return t.node_index==n.node_index&&(t.subnode_index>n.subnode_index&&(o=n,s=t),t.subnode_index==n.subnode_index&&t.offset>n.offset&&(o.offset=n.offset,s.offset=t.offset)),{start_node:o.node,start_offset:o.offset,end_node:s.node,end_offset:s.offset,has_selection:e.baseNode!=e.extentNode||e.baseOffset!=e.extentOffset}},deleteSelection:function(e){var t=e.start_node_index,n=e.start_subnode_index,o=e.start_offset,s=e.start_text,i=e.end_node_index,d=e.end_subnode_index,a=e.end_offset,r=e.end_text,c=s.slice(0,o),l=r.slice(a);if(this.$set(this.nodes[t].content,n,(0,m.A)((0,m.A)({},this.nodes[t].content[n]),{},{text:c+l})),t!=i)this.nodes[t].content.splice(n+1,1/0),this.nodes[i].content.splice(0,d+1),this.nodes[t].content=[].concat((0,p.A)(this.nodes[t].content),(0,p.A)(this.nodes[i].content)),this.nodes.splice(t+1,i-t);else{if(n==d)return;this.nodes[t].content.splice(n+1,d)}},boldSelection:function(e){var t=e.start_node_index,n=e.start_subnode_index,o=e.start_offset,s=e.start_text,i=e.end_node_index,d=e.end_subnode_index,a=e.end_offset,r=e.end_text;if(t==i){var c=(0,m.A)((0,m.A)({},this.nodes[t].content[n]),{},{text:s.slice(0,o)}),l=(0,m.A)((0,m.A)({},this.nodes[t].content[d]),{},{text:r.slice(a)}),u=s.slice(o,a);if(n!=d){var _=s.slice(o),f=r.slice(0,a);u=_;for(var h=n+1;h<d;h++)u+=this.nodes[t].content[h].text;u+=f}this.nodes[t].content=[].concat((0,p.A)(this.nodes[t].content.slice(0,n)),[c,{class:"bold",text:u},l],(0,p.A)(this.nodes[t].content.slice(d+1)))}},insertNode:function(e){this.lastID++,this.nodes=[].concat((0,p.A)(this.nodes.slice(0,e+1)),[{id:this.lastID,type:"paragraph",text:""}],(0,p.A)(this.nodes.slice(e+1)))},_splitNode:function(e){var t=e.start_node_index,n=e.start_subnode_index,o=e.start_offset,s=e.start_text,i=e.end_node_index,d=e.end_subnode_index,a=e.end_offset,r=e.end_text;if(t==i){var c=(0,m.A)((0,m.A)({},this.nodes[t].content[n]),{},{text:s.slice(0,o)}),l=(0,m.A)((0,m.A)({},this.nodes[t].content[d]),{},{text:r.slice(a)||null});console.log(r.slice(a)),console.log(r.slice(a).length);var u=(0,m.A)((0,m.A)({},this.nodes[t]),{},{content:[].concat((0,p.A)(this.nodes[t].content.slice(0,n)),[c])});this.lastID++;var _=(0,m.A)((0,m.A)({},this.nodes[t]),{},{id:this.lastID,content:[l].concat((0,p.A)(this.nodes[t].content.slice(d+1)))});this.nodes=[].concat((0,p.A)(this.nodes.slice(0,t)),[u,_],(0,p.A)(this.nodes.slice(t+1))),console.log(JSON.parse(JSON.stringify(this.nodes)))}},nodeTypeToElement:function(e){switch(e){case"paragraph":return"p";case"header":return"h2";default:return"span"}},setCursor:function(e,t,n){this.$nextTick().then((function(){var o=window.getSelection(),s=document.getElementById("nodes").childNodes[e];if(console.log(s),s){var i=s.childNodes[t];if(console.log(i),i){var d=i.childNodes[0];console.log(d),d&&(o.setBaseAndExtent(d,n,d,n),console.log(o))}}}))},deleteNode:function(e){this.nodes.splice(e,1)},onEditorInput:function(e){var t=this,n=e.inputType;switch(console.log(n),e.inputType){case"formatBold":}this.debounce().then((function(){t.saveDocument()}))},selection_and_range_methods:function(){var e=window.getSelection(),t=e.getRangeAt(0),n=document.getElementById("nodes");t.collapse(!0);t.toString();var o=document.createElement("p");t.surroundContents(o);t.extractContents();t.deleteContents(),n.normalize()},splitNodeAtSelection:function(){var e=window.getSelection(),t=e.baseNode,n=(e.extentNode,e.getRangeAt(0)),o=n.commonAncestorContainer,s=o.nodeName,i=o.className,d=n.extractContents();t.splitText(e.baseOffset);var a=document.createElement(s);a.className=i,a.appendChild(t.nextSibling),t.parentNode.parentNode.insertBefore(a,t.parentNode.nextSibling);var r=document.createElement(s);r.className=i,r.appendChild(d),t.parentNode.parentNode.insertBefore(r,t.parentNode.nextSibling)},splitSelectionWithinNode:function(){var e=range.extractContents();range.insertNode(e)},get_parent_node:function(e){var t,n=document.getElementById("nodes"),o=(0,h.A)(n.childNodes);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(s.contains(e))return s}}catch(i){o.e(i)}finally{o.f()}},get_sub_parent_node:function(e){var t,n=document.getElementById("nodes"),o=(0,h.A)(n.childNodes);try{for(o.s();!(t=o.n()).done;){var s=t.value;if(s.contains(e)&&s.hasChildNodes()){var i,d=(0,h.A)(s.childNodes);try{for(d.s();!(i=d.n()).done;){var a=i.value;if(a.contains(e))return a}}catch(r){d.e(r)}finally{d.f()}}}}catch(r){o.e(r)}finally{o.f()}},get_list_parent_node:function(e,t){if(null===t||void 0===t||!t.hasChildNodes())return null;var n,o=(0,h.A)(t.childNodes);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.contains(e)){if(this.is_list_node(s))return s;var i=this.get_list_parent_node(e,s);if(i)return i}}}catch(d){o.e(d)}finally{o.f()}return null},is_list_node:function(e){return"LI"==(null===e||void 0===e?void 0:e.nodeName)},is_list_container_node:function(e){return"UL"==(null===e||void 0===e?void 0:e.nodeName)||"OL"==(null===e||void 0===e?void 0:e.nodeName)},get_sorted_selection_nodes:function(){var e=window.getSelection(),t=e.baseNode.compareDocumentPosition(e.extentNode);return t&Node.DOCUMENT_POSITION_PRECEDING?{start:e.extentNode,end:e.baseNode}:{start:e.baseNode,end:e.extentNode}},get_all_selected_nodes:function(){var e=this.get_sorted_selection_nodes(),t=this.get_parent_node(e.start);this.is_list_container_node(t)&&(t=this.get_list_parent_node(e.start,document.getElementById("nodes")));var n=this.get_parent_node(e.end);if(this.is_list_container_node(n)&&(n=this.get_list_parent_node(e.end,document.getElementById("nodes"))),t.isSameNode(n))return[t];var o=[],s=t;while(s&&s!=n)o.push(s),s=this.is_list_container_node(s.nextSibling)&&s.nextSibling.hasChildNodes()?s.nextSibling.childNodes[0]:this.is_list_node(s)&&!s.nextSibling?s.parentNode.nextSibling:s.nextSibling;return o.push(n),o},replace_single_node_tag:function(e,t,n,o){if(!this.is_list_node(e)){var s=document.createRange();s.selectNodeContents(e);var i=s.extractContents(),d=document.createElement(t);if(d.className=n,d.append(i),o){var a=document.createElement(o);a.append(d),d=a}e.parentNode.insertBefore(d,e),e.parentNode.removeChild(e)}},replace_list_node_tag:function(e,t,n,o){console.log(e)},apply_to_selected_nodes:function(e,t,n){var o,s=this.get_all_selected_nodes(),i=(0,h.A)(s);try{for(i.s();!(o=i.n()).done;){var d=o.value;this.is_list_node(d)?(console.log("list node"),this.replace_list_node_tag(d,e,t,n)):(console.log("non list node"),this.replace_single_node_tag(d,e,t,n))}}catch(a){i.e(a)}finally{i.f()}},selectionToNode:function(e,t,n){if(this.editing){var o=window.getSelection(),s=o.getRangeAt(0),i=s.collapsed,d=this.get_parent_node(o.baseNode),a=this.get_parent_node(o.extentNode),r=this.is_list_node(d)||this.is_list_node(a);if(!d.isSameNode(a)||d.nodeName!=e||d.className!=t){if(i)if(r){var c=this.get_sub_parent_node(o.baseNode);s.selectNodeContents(c)}else s.selectNodeContents(d);if(r){document.execCommand("outdent",!1,null),o=window.getSelection(),s=o.getRangeAt(0),i=!0,s.selectNodeContents(o.baseNode);var l=o.baseNode.parentNode.nextSibling;"BR"==l.nodeName&&l.parentNode.removeChild(l)}var u=s.extractContents();i||document.execCommand("insertParagraph",!1,null);var _,f=this.get_parent_node(window.getSelection().baseNode);if(n){_=document.createElement(n),_.className=t;var h=document.createElement(e);h.append(u.textContent),_.append(h)}else _=document.createElement(e),_.className=t,_.append(u.textContent);f.parentNode.insertBefore(_,f),i&&f.parentNode.removeChild(f),window.getSelection().getRangeAt(0).setStart(_,0),window.getSelection().getRangeAt(0).setEnd(_,0)}}},replaceTagRecursive:function(e,t,n){var o,s=(0,h.A)(e.childNodes);try{for(s.s();!(o=s.n()).done;){var i=o.value;if("B"==i.nodeName){var d=document.createElement(t);d.className=n,d.innerHTML=i.innerHTML,i.replaceWith(d)}this.replaceTagRecursive(i,t,n)}}catch(a){s.e(a)}finally{s.f()}},replaceSelectedBoldTags:function(e,t){var n=window.getSelection(),o=n.getRangeAt(0);this.replaceTagRecursive(o.commonAncestorContainer,e,t)},onKeyDown:function(e){var t=e.key,n=(e.metaKey,e.shiftKey);e.ctrlKey,e.altKey;if(this.editing){this.getSelectionInfo();"Tab"==t&&(e.preventDefault(),e.stopPropagation(),document.execCommand(n?"outdent":"indent",!1,null))}}},mounted:function(){window.addEventListener("keydown",this.onKeyDown),document.getElementById("nodes").addEventListener("input",this.onEditorInput);var e=window.localStorage.getItem("current_document_id");e&&(this.current_document_id=e,this.fetchDocument(e))},created:function(){this.fetchAllDocuments()}},N=g;var x=(0,r.A)(N,_,f,!1,null,null,null);const y=x.exports;n(2762);var b=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login"},[t("p",[e._v("Login")]),t("input",{attrs:{type:"text",hidden:""},on:{input:function(t){return e.secret=(t.target.value||"").trim()}}}),t("input",{attrs:{type:"email",placeholder:"Email"},on:{input:function(t){return e.email=(t.target.value||"").trim()}}}),t("input",{attrs:{type:"password",placeholder:"Password"},on:{input:function(t){return e.password=(t.target.value||"").trim()}}}),t("button",{on:{click:e.login}},[e._v("Login")]),e.success_message?t("p",{staticClass:"success"},[e._v(e._s(e.success_message))]):e._e(),e.error_message?t("p",{staticClass:"error"},[e._v(e._s(e.error_message))]):e._e()])},w=[];n(4423),n(1699);const A={name:"Login",components:{},data:function(){return{email:"",password:"",secret:"thisissecret",success_message:"",error_message:""}},methods:{test:function(e){console.log(e)},login:function(){var e=this;"thisissecret"==this.secret&&(this.email.includes("@")&&this.email.includes(".")||(this.error_message="Please enter a valid email address."),console.log(this.email),console.log(this.password),v("http://127.0.0.1:5000/login/","POST",{email:this.email,password:this.password}).then((function(t){console.log(t),t.ok?(e.error_message="",e.success_message=t.message,window.localStorage.setItem("token",t.token),window.location.href="/"):(e.success_message="",e.error_message=t.message||"ERROR")})))}}},S=A;var E=(0,r.A)(S,b,w,!1,null,null,null);const C=E.exports;o.Ay.use(u.Ay);var O=[{path:"/",name:"home",component:y},{path:"/login",name:"login",component:C}],T=new u.Ay({routes:O});const k=T;var I=n(1910);o.Ay.use(I.Ay);const D=new I.Ay.Store({state:{},getters:{},mutations:{},actions:{},modules:{}});o.Ay.config.productionTip=!1,new o.Ay({router:k,store:D,render:function(e){return e(l)}}).$mount("#app")}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,(()=>{var e=[];n.O=(t,o,s,i)=>{if(!o){var d=1/0;for(l=0;l<e.length;l++){for(var[o,s,i]=e[l],a=!0,r=0;r<o.length;r++)(!1&i||d>=i)&&Object.keys(n.O).every((e=>n.O[e](o[r])))?o.splice(r--,1):(a=!1,i<d&&(d=i));if(a){e.splice(l--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[o,s,i]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={524:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var s,i,[d,a,r]=o,c=0;if(d.some((t=>0!==e[t]))){for(s in a)n.o(a,s)&&(n.m[s]=a[s]);if(r)var l=r(n)}for(t&&t(o);c<d.length;c++)i=d[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(l)},o=self["webpackChunkclient"]=self["webpackChunkclient"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[504],(()=>n(2102)));o=n.O(o)})();
//# sourceMappingURL=app.f36fc6e8.js.map